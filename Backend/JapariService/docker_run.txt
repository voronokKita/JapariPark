# Networking
docker network create -d overlay --attachable japari_frontend


# Build
# Context: the JapariService base dir
DOCKER_BUILDKIT=1 \
    docker build \
        --secret id=japari_service_user_pass,src=./secrets/.docker-build.secret \
        --file Dockerfile \
        --tag japari_service \
        .


# Run
docker run --detach \
            -it \
            --name JapariService \
            --restart=on-failure:2 \
            --mount type=bind,src="$(pwd)"/logs,dst=/JapariService/logs \
            --publish 8000:80 \
            --network japari_frontend \
            --network-alias japari-service.rest \
            japari_service
